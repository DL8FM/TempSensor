/*******************************************************************************
 * 
 *	TempSensor
 *	Michael Gietl
 *	20210501
 * 
 *	main.c
 * 
 *******************************************************************************/

/*******************************************************************************
 * System Includes
 *******************************************************************************/
#include <avr/io.h>
#include <avr/interrupt.h>


/*******************************************************************************
 * Project Includes
 *******************************************************************************/
#include "main.h"
#include "Timer0.h"
#include "Uart0.h"
 

/*******************************************************************************
 * Local Variables
 *******************************************************************************/
extern volatile unsigned int Timer0ms;
int a = 7;
int b = 70;
int c = 1;
int SetStatus = 1;


/*******************************************************************************
 * Local Function
 *******************************************************************************/
void TempSensorInit(void);


/*******************************************************************************
 * main
 *******************************************************************************/
int main(void) {
	TempSensorInit();		// SystemInit
	sei();
	
	Uart0FifoWrite(&a, &b, &c);
	
	while(1) {
		
		Uart0Transmit();
		if(Timer0ms == 1000) {
			PORTB ^= (1<<STATUSLED);
			Uart0SetStatus(&SetStatus);
			Timer0ms = 0;
		}
	}
	
	
}


void TempSensorInit(void) {
	DDRB = (1 << STATUSLED);
	Timer0Init();
	Uart0Init();
}


ISR (TIMER0_COMPA_vect) {
	//PORTB ^= (1<<STATUSLED);
	Timer0ms ++;
}


